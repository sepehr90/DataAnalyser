@*
* This template takes a single argument, a String containing a
* message to display.
*@


@(D3DataNPost: Html)

@*
* Call the `main` template with two arguments. The first
* argument is a `String` with the title of the page, the second
* argument is an `Html` object containing the body of the page.
*@

@main("FOI Forum") {

<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.12/css/jquery.dataTables.min.css">

<script type="text/javascript" async="" src="https://ssl.google-analytics.com/ga.js"></script><script type="text/javascript" src="/media/js/site.js?_=fdce5da0aafc74f877db6a1772eccba9">
</script>

<script type="text/javascript" language="javascript" src="https://code.jquery.com/jquery-1.12.3.js">
</script>
<script type="text/javascript" language="javascript" src="https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min.js">
</script>
<style>
/* tell the SVG path to be a thin blue line without any area fill */
/* tell the SVG path to be a thin blue line without any area fill */
			path {
				stroke: steelblue;
				stroke-width: 1;
				fill: none;
			}

			.axis {
			  shape-rendering: crispEdges;
			}

			.x.axis line {
			  stroke: lightgrey;
			}

			.x.axis .minor {
			  stroke-opacity: .9;
			}

			.x.axis path {
			  display: none;
			}

			.y.axis line, .y.axis path {
			  fill: none;
			  stroke: #000;
			}
* {
  box-sizing: border-box;
}

#myInput {

  width: 100%;
  font-size: 18px;
  font-weight: bold;
  border: 1px solid #ddd;
  margin-bottom: 12px;
}

#myUL {
  list-style-type: none;
  font-weight: bold;
  padding: 0;
  margin: 0;
}

#myUL li a {
  border: 1px solid #ddd;
  margin-top: -1px; /* Prevent double borders */
  background-color: #f6f6f6;
  padding: 12px;
  text-decoration: none;
  font-size: 18px;
  font-weight: bold;
  color: black;
  display: block
}

#myUL li a.header {
  background-color: #e2e2e2;
  cursor: default;
}

#myUL li a:hover:not(.header) {
  background-color: #eee;
}

.bar {
  fill: #668cff;
}

.bar:hover {
  fill: #ffff80;
}

.axis {
  font: 10px sans-serif;
  font-weight: bold;
}

.axis path,
.axis line {
  fill: none;
  stroke: #000;
  shape-rendering: crispEdges;
}

.x.axis path {
  display: none;
}

.d3-tip {
  line-height: 1;
  font-weight: bold;
  padding: 12px;
  background: rgba(0, 0, 0, 0.8);
  color: #fff;
  border-radius: 2px;
}

div.tooltip {
   line-height: 1;
  font-weight: bold;
  padding: 12px;
  background: rgba(0, 0, 0, 0.8);
  color: #fff;
  border-radius: 2px;
}
td {border: 1px #DDD solid; padding: 5px; cursor: pointer;}

.selected {
    background-color: brown;
    color: #FFF;
}
</style>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

<!-- Website CSS style -->
<link rel="stylesheet" media="screen" href="@routes.Assets.versioned("stylesheets/main.css")">
<link rel="stylesheet" media="screen" href="@routes.Assets.versioned("stylesheets/AnimatingButtons.css")">
<link rel="stylesheet" media="screen" href="@routes.Assets.versioned("stylesheets/Popupforbarchart.css")">
<link rel="stylesheet" media="screen" href="@routes.Assets.versioned("stylesheets/Reloader.css")">

<!-- Website Font style -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css">

<!-- Google Fonts -->
<link href='https://fonts.googleapis.com/css?family=Passion+One' rel='stylesheet' type='text/css'>
<link href='https://fonts.googleapis.com/css?family=Oxygen' rel='stylesheet' type='text/css'>

<div class="container-fluid" style="margin-top:20px;margin-left:10px;" >
    <script>
  var D3DataNPost = @D3DataNPost;

  console.log(D3DataNPost);
</script>
   <div class="row">
        <div class="col-xs-5">
                    <div class="well" style="min-height: 640px;max-height: 640px;overflow: auto;">
                        <table id="example" class="table table-striped table-bordered" cellspacing="0" width="100%">
                            <tbody>

                            <tr>
                                <td>
                                    <table id="example1" class="display" width="100%"></table>

                                </td>
                            </tr>

                            </tbody>
                        </table>
                    </div>
        </div>
        <div class="col-xs-7" style="background-color:#f2f2f2;">
            <div id="pt-main" class="pt-perspective">
                <div class="pt-page pt-page-1" id="page1">
                    <div class="row">
                        <div class="col-xs-3"></div>
                        <div class="col-xs-6" style="float:left"><br/><h4 style="top: 15px; font-family: Elephant; font-size: 18px">Silkroad users and number of posts</h4></div>
                        <div class="col-xs-2"></div>
                        <div class="col-xs-1">
                            <a id="update1" href="#">
                                <i class="glyphicon glyphicon-refresh" style="top: 15px; font-size: 30px"></i>
                            </a>
                        </div>
                    </div>
                    <div id="outer" class="out" width="900" style="overflow: auto;">
                    <div id="inner" class="in" height="700">
                        <div id="svgframe"></div>

                    </div>
                </div>
                </div>
                <div class="pt-page pt-page-2" id="page2">
                    <div style="float:right"><a id="update2" href="#"><i class="glyphicon glyphicon-refresh" style="top: 15px;font-size: 30px"></i></a></div>
                    <div id="graph"></div></div>
                <div class="pt-page pt-page-3" id="page3">
                    <div style="float:right"><a id="update3" href="#"><i class="glyphicon glyphicon-refresh" style="top: 15px;font-size: 30px"></i></a></div>
                    <div id="outer3" class="out" width="900" style="overflow: auto;">
                    <div id="inner3" class="in" height="700">
                        <div id="linegraph"></div>
                    </div>
                </div>
                </div>
                <div class="pt-page pt-page-4" id="page4">
                    <div style="float:right"><a id="update4" href="#"><i class="glyphicon glyphicon-refresh" style="top: 15px;font-size: 30px"></i></a></div>
                    <div id="chart"></div></div>
                <div class="pt-page pt-page-5" id="page5">
                    <div style="float:right"><a id="update5" href="#"><i class="glyphicon glyphicon-refresh" style="top: 15px;font-size: 30px"></i></a></div>
                    <div id="Highchart"></div></div>

            </div>
            <ul class="pager">
                <li><button id="Page-Transition"  onClick="slideShow(false)" class="btn btn-success" >Previous</button></li>
                <li><button id="Page-Transition1"  onClick="slideShow(true)" class="btn btn-success">Next</button></li>
            </ul>
        </div>



        <script src="@routes.Assets.versioned("javascripts/d3.min.js")" type="text/javascript"></script>
        <script src="http://d3js.org/d3.v3.min.js"></script>
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
        <script src="http://cdnjs.cloudflare.com/ajax/libs/d3/3.4.11/d3.min.js"></script>
        <script src="http://labratrevenge.com/d3-tip/javascripts/d3.tip.v0.6.3.js"></script>
        <script src="@routes.Assets.versioned("javascripts/cloud.js")" type="text/javascript"></script>
        <script src="@routes.Assets.versioned("javascripts/c3.min.js")" type="text/javascript"></script>
        <script src="@routes.Assets.versioned("javascripts/highchart.js")" type="text/javascript"></script>





        <script>
//show and hide based on the search
$("#searchInput").keyup(function () {
    var rows = $("#fbody").find("tr").hide();
    if (this.value.length) {
        var data = this.value.split(" ");
        $.each(data, function (i, v) {
            rows.filter(":contains('" + v + "')").show();
        });
    } else rows.show();
});

//Creating data table using Jquery
var dataset = @D3DataNPost;
var DataArray = new Array(Object.keys(dataset).length);
var BarFilter = [];
for (i = 0; i < Object.keys(dataset).length; i++) {
        DataArray[i] = new Array(2);
        for (j = 0; j < 2; j++) {
            if (j == 0)
            {DataArray[i][j] = dataset[i].username;}
            if (j == 1)
            {DataArray[i][j] = dataset[i].numberofposts;}
            }
        }
$(document).ready(function() {
    var table =  $('#example1').DataTable( {
        data: DataArray,
        columns: [
            { title: "username" },
            { title: "numberofposts" }
        ]
    } );

    $('#example1 tbody').on( 'click', 'tr', function () {
        $(this).toggleClass('selected');

        //console.log( table.row( this ).data() );
    } );


    $('#update1').click(function(){
        $.map(table.rows('.selected').data(), function (item) {
            var obj = {
            "username" : item[0],    //your artist variable
            "numberofposts" : item[1]   //your title variable
        };
            BarFilter.push(obj);
            return (BarFilter);
        });
        $('#svgframe').fadeOut(3000)
        $('#svgframe').empty()
        if(BarFilter === undefined || BarFilter === null)
        {barchart(dataset);}
        else{barchart(BarFilter);}
        $('#svgframe').fadeIn("slow");
        BarFilter = [];
    });

} );



//animating the refresh chart button
      $(document).ready( function() {
  $("#update1").on("click", function() {
    var $icon = $(this).find(".glyphicon.glyphicon-refresh"), animateClass = "glyphicon-refresh-animate";
    $icon.addClass(animateClass);
    window.setTimeout(function() {
      $icon.removeClass(animateClass);
    }, 2000);
   });
});
    $(document).ready( function() {
  $("#update2").on("click", function() {
    var $icon = $(this).find(".glyphicon.glyphicon-refresh"), animateClass = "glyphicon-refresh-animate";
    $icon.addClass(animateClass);
    window.setTimeout(function() {
      $icon.removeClass(animateClass);
    }, 2000);
   });
});
    $(document).ready( function() {
  $("#update3").on("click", function() {
    var $icon = $(this).find(".glyphicon.glyphicon-refresh"), animateClass = "glyphicon-refresh-animate";
    $icon.addClass(animateClass);
    window.setTimeout(function() {
      $icon.removeClass(animateClass);
    }, 2000);
   });
});
    $(document).ready( function() {
  $("#update4").on("click", function() {
    var $icon = $(this).find(".glyphicon.glyphicon-refresh"), animateClass = "glyphicon-refresh-animate";
    $icon.addClass(animateClass);
    window.setTimeout(function() {
      $icon.removeClass(animateClass);
    }, 2000);
   });
});

//the refresh button
$(document).ready( function() {
  $("#update5").on("click", function() {
    var $icon = $(this).find(".glyphicon.glyphicon-refresh"), animateClass = "glyphicon-refresh-animate";
    $icon.addClass(animateClass);
    window.setTimeout(function() {
      $icon.removeClass(animateClass);
    }, 6000);
   });
});



        function slideShow(mode){
          if(mode){
            $('#pt-main .pt-page:visible').eq(0).slideUp(500,function(){
              $(this).next('.pt-page').slideDown(300);
              $(this).appendTo('#pt-main');
            });
          }else{
            $('#pt-main .pt-page:visible').eq(0).slideUp(500,function(){
              $('#pt-main .pt-page:last').slideDown(300).prependTo('#pt-main');
            });
          }
        }
        $('#pt-main .pt-page').hide().eq(0).show();

//Graphic for refreshing the bar chart
$(document).ready(function(){
    $('#update1').click(function(){
        $.map(table.rows('.selected').data(), function (item) {
            var obj = {
            "username" : item[0],    //your artist variable
            "numberofposts" : item[1]   //your title variable
        };
            BarFilter.push(obj);
            return (BarFilter);
        });
        $('#svgframe').fadeOut(3000)
        $('#svgframe').empty()
        barchart(BarFilter);
        $('#svgframe').fadeIn("slow");
        BarFilter = [];
    });
});


function barchart(MyUserObject){
        //document.getElementById('spinner').style.display='none';
        //var MyUserObject = @D3DataNPost;
        var w = (Object.keys(MyUserObject).length)* 21;
        console.log("This is how many objects we have:" + Object.keys(MyUserObject).length);
        var h = 480;
        var barPadding = 1;
        document.getElementById('inner').style.width = w + "px";
        document.getElementById('svgframe').style.width = w + "px";
        contextMenuShowing = false;
        var div = d3.select("body").append("div")
            .attr("class", "tooltip")
            .style("opacity", 0);
        var canvas = d3.select('#svgframe')
            .append("svg")
            .attr("width", w)
            .attr("height", h);
            var bars = canvas.selectAll("g")
                        .data(MyUserObject)
                        .enter()
                        .append("g")
                        bars.append("rect")
                            .filter(function(d) { return d.numberofposts})
                            .attr('class', 'bar')
                            .attr("width", 23)
                            .attr("height", function(d){
                            if(d.numberofposts < 10)
                            {return d.numberofposts}
                            else
                            {return d.numberofposts/13}
                            })
                            .attr("x", function(d, i){ return i * 25})
                            .attr("y", function(d){
                            if(d.numberofposts < 10)
                            {return h-(d.numberofposts)}
                            else
                            {return h-(d.numberofposts/13)}
                            })
                            .attr("fill", function(d) {
                            return "#668cff";
                            })

                            .on("mouseover", function(d) {
                            div.transition()
                                .duration(100)
                                .style("opacity", .9);
                            div.html("#Posts: "+d.numberofposts)
                                .style("left", (d3.event.pageX) + "px")
                                .style("top", (d3.event.pageY - 28) + "px");
                            })
                            .on("mouseout", function(d) {
                                div.transition()
                                    .duration(300)
                                    .style("opacity", 0);
                            })

                            .on("click",function (d,i) {
                                if(contextMenuShowing) {
                                    d3.event.preventDefault();
                                    d3.select(".popup").remove();
                                    contextMenuShowing = false;
                                } else {
                                    d3_target = d3.select(d3.event.target);
                                    if (d3_target.classed("bar")) {
                                        d3.event.preventDefault();
                                        contextMenuShowing = true;
                                        d = d3_target.datum();

                                        // Build the popup
                                        popup = d3.select('#svgframe')
                                        .append("div")
                                        .attr("class", "popup")
                                        .style("left", "540px")
                                        .style("top", "80px")
                                        popup.append("h2").text(d.numberofposts)
                                        popup.append("p").text(
                                            "The " + d.numberofposts + " division (wearing " + d.numberofposts + " uniforms) had " + d.numberofposts + " casualties during the show's original run.")
                                        popup.append("p")
                                        .text(d.numberofposts);
                                    }
                                }
                            });

                        bars.append("text")
                            .filter(function(d) { return d.numberofposts})
                            .text(function(d) {
                            return (d.username);
                            })
                            .attr("x", -h)
                            .attr("y", function(d, i){ return i * 25})
                            .attr("fill", "#330022")
                            .attr("font-family", "sans-serif")
                            .attr("font-size", "12px")
                            .attr("font-weight", "bold")
                            .style("text-anchor", "start")
                            .attr("dx", ".95em")
                            .attr("dy", ".95em")
                            .attr("transform", "rotate(-90)");
            console.log(d3);
            }


function LineGraph(){
var MyUserObject = @D3DataNPost;
var m = [80, 80, 80, 80]; // margins
		//var w = 1000 - m[1] - m[3]; // width
		var w = (Object.keys(MyUserObject).length);
		var h = 540 - m[0] - m[2]; // height
		document.getElementById('inner3').style.width = w + "px";
        document.getElementById('linegraph').style.width = w + "px";
        //document.getElementById('inner2').style.width = w + "px";
		// X scale will fit all values from data[] within pixels 0-w
		var x = d3.scale.linear().domain([0, Object.keys(MyUserObject).length]).range([0, w]);
		// Y scale will fit values from 0-10 within pixels h-0 (Note the inverted domain for the y-scale: bigger is up!)
		var y = d3.scale.linear().domain([0, 200]).range([h, 0]);
			// automatically determining max range can work something like this
			// var y = d3.scale.linear().domain([0, d3.max(MyUserObject.numberofposts%200)]).range([h, 0]);
		// create a line function that can convert data[] into x and y points
		var line = d3.svg.line()
			// assign the X function to plot our line as we wish
			.x(function(d,i) {
				// verbose logging to show what's actually being done
				console.log('Plotting X value for data point: ' + d + ' using index: ' + i + ' to be at: ' + x(i) + ' using our xScale.');
				// return the X coordinate where we want to plot this datapoint
				return x(i);
			})
			.y(function(d) {
				// verbose logging to show what's actually being done
				console.log('Plotting Y value for data point: ' + d + ' to be at: ' + y(d.numberofposts) + " using our yScale.");
				// return the Y coordinate where we want to plot this datapoint
				return y(d.numberofposts%200);
			})
			// Add an SVG element with the desired dimensions and margin.
			var graph = d3.select('#linegraph')
			      .append("svg:svg")
			      .attr("width", w + m[1] + m[3])
			      .attr("height", h + m[0] + m[2])
			    .append("svg:g")
			      .attr("transform", "translate(" + m[3] + "," + m[0] + ")");

			// create yAxis
			var xAxis = d3.svg.axis().scale(x).tickSize(-h).tickSubdivide(true);
			// Add the x-axis.
			graph.append("svg:g")
			      .attr("class", "x axis")
			      .attr("transform", "translate(0," + h + ")")
			      .call(xAxis);
			// create left yAxis
			var yAxisLeft = d3.svg.axis().scale(y).ticks(4).orient("left");
			// Add the y-axis to the left
			graph.append("svg:g")
			      .attr("class", "y axis")
			      .attr("transform", "translate(-25,0)")
			      .call(yAxisLeft);
  			// Add the line by appending an svg:path element with the data line we created above
			// do this AFTER the axes above so that the line is above the tick-lines
  			graph.append("svg:path").attr("d", line(MyUserObject));
}


        function cloud(){

         var text_string = "Of course that’s your contention. You’re a first year grad student. You just got finished readin’ some Marxian historian, Pete Garrison probably. You’re gonna be convinced of that ’til next month when you get to James Lemon and then you’re gonna be talkin’ about how the economies of Virginia and Pennsylvania were entrepreneurial and capitalist way back in 1740. That’s gonna last until next year. You’re gonna be in here regurgitating Gordon Wood, talkin’ about, you know, the Pre-Revolutionary utopia and the capital-forming effects of military mobilization… ‘Wood drastically underestimates the impact of social distinctions predicated upon wealth, especially inherited wealth.’ You got that from Vickers, Work in Essex County, page 98, right? Yeah, I read that, too. Were you gonna plagiarize the whole thing for us? Do you have any thoughts of your own on this matter? Or do you, is that your thing? You come into a bar. You read some obscure passage and then pretend, you pawn it off as your own, as your own idea just to impress some girls and embarrass my friend? See, the sad thing about a guy like you is in 50 years, you’re gonna start doin’ some thinkin’ on your own and you’re gonna come up with the fact that there are two certainties in life. One: don’t do that. And two: you dropped a hundred and fifty grand on a fuckin’ education you coulda got for a dollar fifty in late charges at the public library.";

      drawWordCloud(text_string);

      function drawWordCloud(text_string){
        var common = "poop,i,me,my,myself,we,us,our,ours,ourselves,you,your,yours,yourself,yourselves,he,him,his,himself,she,her,hers,herself,it,its,itself,they,them,their,theirs,themselves,what,which,who,whom,whose,this,that,these,those,am,is,are,was,were,be,been,being,have,has,had,having,do,does,did,doing,will,would,should,can,could,ought,i'm,you're,he's,she's,it's,we're,they're,i've,you've,we've,they've,i'd,you'd,he'd,she'd,we'd,they'd,i'll,you'll,he'll,she'll,we'll,they'll,isn't,aren't,wasn't,weren't,hasn't,haven't,hadn't,doesn't,don't,didn't,won't,wouldn't,shan't,shouldn't,can't,cannot,couldn't,mustn't,let's,that's,who's,what's,here's,there's,when's,where's,why's,how's,a,an,the,and,but,if,or,because,as,until,while,of,at,by,for,with,about,against,between,into,through,during,before,after,above,below,to,from,up,upon,down,in,out,on,off,over,under,again,further,then,once,here,there,when,where,why,how,all,any,both,each,few,more,most,other,some,such,no,nor,not,only,own,same,so,than,too,very,say,says,said,shall";

        var word_count = {};

        var words = text_string.split(/[ '\-\(\)\*":;\[\]|{},.!?]+/);
          if (words.length == 1){
            word_count[words[0]] = 1;
          } else {
            words.forEach(function(word){
              var word = word.toLowerCase();
              if (word != "" && common.indexOf(word)==-1 && word.length>1){
                if (word_count[word]){
                  word_count[word]++;
                } else {
                  word_count[word] = 1;
                }
              }
            })
          }

        var svg_location = '#graph';
        //var width = $(document).width();
        //var height = $(document).height();
        var MyUserObject = @D3DataNPost;
        var w = (Object.keys(MyUserObject).length);
        var height = 530;
        document.getElementById('inner').style.width = w + "px";
        document.getElementById('chart').style.width = w + "px";
        var fill = d3.scale.category20();

        var word_entries = d3.entries(word_count);

        var xScale = d3.scale.linear()
           .domain([0, d3.max(word_entries, function(d) {
              return d.value;
            })
           ])
           .range([10,100]);

        d3.layout.cloud().size([width, height])
          .timeInterval(20)
          .words(word_entries)
          .fontSize(function(d) { return xScale(+d.value); })
          .text(function(d) { return d.key; })
          .rotate(function() { return ~~(Math.random() * 2) * 90; })
          .font("Impact")
          .on("end", draw)
          .start();

        function draw(words) {
          d3.select(svg_location).append("svg")
              .attr("width", width)
              .attr("height", height)
            .append("g")
              .attr("transform", "translate(" + [width >> 1, height >> 1] + ")")
            .selectAll("text")
              .data(words)
            .enter().append("text")
              .style("font-size", function(d) { return xScale(d.value) + "px"; })
              .style("font-family", "Impact")
              .style("fill", function(d, i) { return fill(i); })
              .attr("text-anchor", "middle")
              .attr("transform", function(d) {
                return "translate(" + [d.x, d.y] + ")rotate(" + d.rotate + ")";
              })
              .text(function(d) { return d.key; });
        }

        d3.layout.cloud().stop();
      }
        }

         function c3line(){
         var MyUserObject = @D3DataNPost;
         var arrnumberofpost = Object.keys(MyUserObject).map(function(k) { return MyUserObject[k].numberofposts });
         var arrusername = Object.keys(MyUserObject).map(function(k) { return MyUserObject[k].username });

         var chart = c3.generate({
    data: {
        columns: [
            [arrnumberofpost[0]%200,arrnumberofpost[1]%200,arrnumberofpost[2]%200],
            [arrusername[0],arrusername[1],arrusername[2]]
        ]
    }

});
console.log(arrusername);
}


function AnimatedBarChart(){
var margin = {top: 20, right: 20, bottom: 30, left: 40},
    width = 960 - margin.left - margin.right,
    height = 520 - margin.top - margin.bottom;

// D3 scales = just math
// x is a function that transforms from "domain" (data) into "range" (usual pixels)
// domain gets set after the data loads
var x = d3.scale.ordinal()
    .rangeRoundBands([0, width], .1);

var y = d3.scale.linear()
    .range([height, 0]);

// D3 Axis - renders a d3 scale in SVG
var xAxis = d3.svg.axis()
    .scale(x)
    .orient("bottom");

var yAxis = d3.svg.axis()
    .scale(y)
    .orient("left")
    .ticks(10, "%");

// create an SVG element (appended to body)
// set size
// add a "g" element (think "group")
// annoying d3 gotcha - the 'svg' variable here is a 'g' element
// the final line sets the transform on <g>, not on <svg>
var svg = d3.select('#Highchart').append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
  .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

svg.append("g")
    .attr("class", "x axis")
    .attr("transform", "translate(0," + height + ")")

svg.append("g")
    .attr("class", "y axis")
  .append("text") // just for the title (ticks are automatic)
    .attr("transform", "rotate(-90)") // rotate the text!
    .attr("y", 6)
    .attr("dy", ".71em")
    .style("text-anchor", "end")
    .text("Frequency");

// d3.tsv is a wrapper around XMLHTTPRequest, returns array of arrays (?) for a TSV file
// type function transforms strings to numbers, dates, etc.
d3.tsv("data.tsv", type, function(error, data) {
  replay(data);
});

function type(d) {
  // + coerces to a Number from a String (or anything)
  d.frequency = +d.frequency;
  return d;
}

function replay(data) {
  var slices = [];
  for (var i = 0; i < data.length; i++) {
    slices.push(data.slice(0, i+1));
  }
  slices.forEach(function(slice, index){
    setTimeout(function(){
      draw(slice);
    }, index * 300);
  });
}

function draw(data) {
  // measure the domain (for x, unique letters) (for y [0,maxFrequency])
  // now the scales are finished and usable
  x.domain(data.map(function(d) { return d.letter; }));
  y.domain([0, d3.max(data, function(d) { return d.frequency; })]);

  // another g element, this time to move the origin to the bottom of the svg element
  // someSelection.call(thing) is roughly equivalent to thing(someSelection[i])
  //   for everything in the selection\
  // the end result is g populated with text and lines!
  svg.select('.x.axis').transition().duration(300).call(xAxis);

  // same for yAxis but with more transform and a title
  svg.select(".y.axis").transition().duration(300).call(yAxis)

  // THIS IS THE ACTUAL WORK!
  var bars = svg.selectAll(".bar").data(data, function(d) { return d.letter; }) // (data) is an array/iterable thing, second argument is an ID generator function

  bars.exit()
    .transition()
      .duration(300)
    .attr("y", y(0))
    .attr("height", height - y(0))
    .style('fill-opacity', 1e-6)
    .remove();

  // data that needs DOM = enter() (a set/selection, not an event!)
  bars.enter().append("rect")
    .attr("class", "bar")
    .attr("y", y(0))
    .attr("height", height - y(0));

  // the "UPDATE" set:
  bars.transition().duration(300).attr("x", function(d) { return x(d.letter); }) // (d) is one item from the data array, x is the scale object from above
    .attr("width", x.rangeBand()) // constant, so no callback function(d) here
    .attr("y", function(d) { return y(d.frequency); })
    .attr("height", function(d) { return height - y(d.frequency); }); // flip the height, because y's domain is bottom up, but SVG renders top down

}
}

function start() {
	  //barchart(@D3DataNPost);
	  barchart(dataset);
	  cloud();
	  LineGraph();
	}
	window.onload = start;
</script>


    </div>
</div>
<script>
$('#checkAll').click(function() {
  $('.check').prop('checked', $(this).prop('checked'));
});
$(document).ready(function() {
    // Setup - add a text input to each footer cell
    $('#example tfoot th').each( function () {
        var title = $(this).text();
        $(this).html( '<input type="text" placeholder="Search '+title+'" />' );
    } );

    // DataTable
    var table = $('#example').DataTable();

    // Apply the search
    table.columns().every( function () {
        var that = this;

        $( 'input', this.footer() ).on( 'keyup change', function () {
            if ( that.search() !== this.value ) {
                that
                    .search( this.value )
                    .draw();
            }
        } );
    } );
} );
</script>
}

